"use strict";const u=require("../../../../common/vendor.js"),h={name:"UniRate",props:{isFill:{type:[Boolean,String],default:!0},color:{type:String,default:"#ececec"},activeColor:{type:String,default:"#ffca3e"},disabledColor:{type:String,default:"#c0c0c0"},size:{type:[Number,String],default:24},value:{type:[Number,String],default:0},modelValue:{type:[Number,String],default:0},max:{type:[Number,String],default:5},margin:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1},readonly:{type:[Boolean,String],default:!1},allowHalf:{type:[Boolean,String],default:!1},touchable:{type:[Boolean,String],default:!0}},data(){return{valueSync:"",userMouseFristMove:!0,userRated:!1,userLastRate:1}},watch:{value(e){this.valueSync=Number(e)},modelValue(e){this.valueSync=Number(e)}},computed:{stars(){const e=this.valueSync?this.valueSync:0,s=[],a=Math.floor(e),i=Math.ceil(e);for(let n=0;n<this.max;n++)a>n?s.push({activeWitch:"100%"}):i-1===n?s.push({activeWitch:(e-a)*100+"%"}):s.push({activeWitch:"0"});return s},marginNumber(){return Number(this.margin)}},created(){this.valueSync=Number(this.value||this.modelValue),this._rateBoxLeft=0,this._oldValue=null},mounted(){setTimeout(()=>{this._getSize()},100)},methods:{touchstart(e){if(this.readonly||this.disabled)return;const{clientX:s,screenX:a}=e.changedTouches[0];this._getRateCount(s||a)},touchmove(e){if(this.readonly||this.disabled||!this.touchable)return;const{clientX:s,screenX:a}=e.changedTouches[0];this._getRateCount(s||a)},mousedown(e){},mousemove(e){},mouseleave(e){},_getRateCount(e){this._getSize();const s=Number(this.size);if(isNaN(s))return new Error("size 属性只能设置为数字");const a=e-this._rateBoxLeft;let i=parseInt(a/(s+this.marginNumber));i=i<0?0:i,i=i>this.max?this.max:i;const n=parseInt(a-(s+this.marginNumber)*i);let t=0;this._oldValue===i&&!this.PC||(this._oldValue=i,this.allowHalf?n>s/2?t=i+1:t=i+.5:t=i+1,t=Math.max(.5,Math.min(t,this.max)),this.valueSync=t,this._onChange())},_onChange(){this.$emit("input",this.valueSync),this.$emit("update:modelValue",this.valueSync),this.$emit("change",{value:this.valueSync})},_getSize(){u.index.createSelectorQuery().in(this).select(".uni-rate").boundingClientRect().exec(e=>{e&&(this._rateBoxLeft=e[0].left)})}}};Array||u.resolveComponent("uni-icons")();const m=()=>"../../../uni-icons/components/uni-icons/uni-icons.js";Math||m();function d(e,s,a,i,n,t){return{a:u.f(t.stars,(c,o,r)=>({a:"29f22628-0-"+r,b:"29f22628-1-"+r,c:c.activeWitch,d:o,e:u.o((...l)=>t.touchstart&&t.touchstart(...l),o),f:u.o((...l)=>t.touchmove&&t.touchmove(...l),o),g:u.o((...l)=>t.mousedown&&t.mousedown(...l),o),h:u.o((...l)=>t.mousemove&&t.mousemove(...l),o),i:u.o((...l)=>t.mouseleave&&t.mouseleave(...l),o)})),b:u.p({color:a.color,size:a.size,type:a.isFill?"star-filled":"star"}),c:u.p({color:a.disabled?a.disabledColor:a.activeColor,size:a.size,type:"star-filled"}),d:a.disabled?1:"",e:t.marginNumber+"px"}}const f=u._export_sfc(h,[["render",d],["__file","/Users/izcw/Desktop/我的项目/DuoyuWallpaper/uni_modules/uni-rate/components/uni-rate/uni-rate.vue"]]);wx.createComponent(f);
