"use strict";const e=require("../../../../../common/vendor.js"),p={},v=()=>Promise.resolve().then(()=>w),_={name:"node",options:{addGlobalClass:!1},data(){return{ctrl:{}}},props:{name:String,attrs:{type:Object,default(){return{}}},childs:Array,opts:Array},components:{node:v},mounted(){this.$nextTick(()=>{for(this.root=this.$parent;this.root.$options.name!=="mp-html";this.root=this.root.$parent);})},beforeDestroy(){},methods:{play(o){if(this.root.$emit("play"),this.root.pauseVideo){let r=!1;const s=o.target.id;for(let i=this.root._videos.length;i--;)this.root._videos[i].id===s?r=!0:this.root._videos[i].pause();if(!r){const i=e.index.createVideoContext(s,this);i.id=s,this.root.playbackRate&&i.playbackRate(this.root.playbackRate),this.root._videos.push(i)}}},imgTap(o){const r=this.childs[o.currentTarget.dataset.i];if(r.a){this.linkTap(r.a);return}r.attrs.ignore||(this.root.$emit("imgtap",r.attrs),this.root.previewImg&&e.index.previewImage({current:parseInt(r.attrs.i),urls:this.root.imgList}))},imgLongTap(o){},imgLoad(o){const r=o.currentTarget.dataset.i;this.childs[r].w?(this.opts[1]&&!this.ctrl[r]||this.ctrl[r]===-1)&&this.$set(this.ctrl,r,1):this.$set(this.ctrl,r,o.detail.width),this.checkReady()},checkReady(){this.root&&!this.root.lazyLoad&&(this.root._unloadimgs-=1,this.root._unloadimgs||setTimeout(()=>{this.root.getRect().then(o=>{this.root.$emit("ready",o)}).catch(()=>{this.root.$emit("ready",{})})},350))},linkTap(o){const r=o.currentTarget?this.childs[o.currentTarget.dataset.i]:{},s=r.attrs||o,i=s.href;this.root.$emit("linktap",Object.assign({innerText:this.root.getText(r.children||[])},s)),i&&(i[0]==="#"?this.root.navigateTo(i.substring(1)).catch(()=>{}):i.split("?")[0].includes("://")?this.root.copyLink&&e.index.setClipboardData({data:i,success:()=>e.index.showToast({title:"链接已复制"})}):e.index.navigateTo({url:i,fail(){e.index.switchTab({url:i,fail(){}})}}))},mediaError(o){const r=o.currentTarget.dataset.i,s=this.childs[r];if(s.name==="video"||s.name==="audio"){let i=(this.ctrl[r]||0)+1;if(i>s.src.length&&(i=0),i<s.src.length){this.$set(this.ctrl,r,i);return}}else s.name==="img"&&(this.opts[2]&&this.$set(this.ctrl,r,-1),this.checkReady());this.root&&this.root.$emit("error",{source:s.name,attrs:s.attrs,errMsg:o.detail.errMsg})}}};Array||e.resolveComponent("node")();function k(o,r,s,i,m,l){return{a:e.f(s.childs,(t,c,d)=>e.e({a:t.name==="img"&&!t.t&&(s.opts[1]&&!m.ctrl[c]||m.ctrl[c]<0)},t.name==="img"&&!t.t&&(s.opts[1]&&!m.ctrl[c]||m.ctrl[c]<0)?{b:e.s(t.attrs.style),c:m.ctrl[c]<0?s.opts[2]:s.opts[1]}:{},{d:t.name==="img"&&t.t},t.name==="img"&&t.t?{e:e.s("display:"+t.t),f:[{attrs:{style:t.attrs.style||"",src:t.attrs.src},name:"img"}],g:c,h:e.o((...a)=>l.imgTap&&l.imgTap(...a))}:t.name==="img"?{j:t.attrs.id,k:e.n("_img "+t.attrs.class),l:e.s((m.ctrl[c]===-1?"display:none;":"")+"width:"+(m.ctrl[c]||1)+"px;height:1px;"+t.attrs.style),m:t.attrs.src,n:t.h?t.w?t.m||"scaleToFill":"heightFix":"widthFix",o:s.opts[0],p:t.webp,q:s.opts[3]&&!t.attrs.ignore,r:!s.opts[3]||t.attrs.ignore,s:c,t:e.o((...a)=>l.imgLoad&&l.imgLoad(...a)),v:e.o((...a)=>l.mediaError&&l.mediaError(...a)),w:e.o((...a)=>l.imgTap&&l.imgTap(...a)),x:e.o((...a)=>l.imgLongTap&&l.imgLongTap(...a))}:t.name==="br"?{}:t.name==="a"?{A:"502f1182-0-"+d,B:e.p({name:"span",childs:t.children,opts:s.opts}),C:t.attrs.id,D:e.n((t.attrs.href?"_a ":"")+t.attrs.class),E:e.s("display:inline;"+t.attrs.style),F:c,G:e.o((...a)=>l.linkTap&&l.linkTap(...a))}:t.name==="video"?{I:t.attrs.id,J:e.n(t.attrs.class),K:e.s(t.attrs.style),L:t.attrs.autoplay,M:t.attrs.controls,N:t.attrs.loop,O:t.attrs.muted,P:t.attrs["object-fit"],Q:t.attrs.poster,R:t.src[m.ctrl[c]||0],S:c,T:e.o((...a)=>l.play&&l.play(...a)),U:e.o((...a)=>l.mediaError&&l.mediaError(...a))}:t.name==="table"&&t.c||t.name==="li"?e.e({W:t.name==="li"},t.name==="li"?{X:"502f1182-1-"+d,Y:e.p({childs:t.children,opts:s.opts})}:{Z:e.f(t.children,(a,g,n)=>e.e({a:a.name==="td"||a.name==="th"},a.name==="td"||a.name==="th"?{b:"502f1182-2-"+d+"-"+n,c:e.p({childs:a.children,opts:s.opts})}:{d:e.f(a.children,(h,y,u)=>e.e({a:h.name==="td"||h.name==="th"},h.name==="td"||h.name==="th"?{b:"502f1182-3-"+d+"-"+n+"-"+u,c:e.p({childs:h.children,opts:s.opts}),d:e.n("_"+h.name+" "+h.attrs.class),e:e.s(h.attrs.style)}:{f:e.f(h.children,(f,b,T)=>({a:"502f1182-4-"+d+"-"+n+"-"+u+"-"+T,b:e.p({childs:f.children,opts:s.opts}),c:b,d:e.n("_"+f.name+" "+f.attrs.class),e:e.s(f.attrs.style)})),g:e.n("_"+h.name+" "+h.attrs.class),h:e.s(h.attrs.style)},{i:y}))},{e:g,f:e.n("_"+a.name+" "+a.attrs.class),g:e.s(a.attrs.style)}))},{aa:t.attrs.id,ab:e.n("_"+t.name+" "+t.attrs.class),ac:e.s(t.attrs.style)}):t.c?t.c===2?{ak:e.f(t.children,(a,g,n)=>({a:g,b:e.s(a.f),c:"502f1182-5-"+d+"-"+n,d:e.p({name:a.name,attrs:a.attrs,childs:a.children,opts:s.opts})})),al:t.attrs.id,am:e.n("_block _"+t.name+" "+t.attrs.class),an:e.s(t.f+";"+t.attrs.style)}:{ao:e.s(t.f),ap:"502f1182-6-"+d,aq:e.p({name:t.name,attrs:t.attrs,childs:t.children,opts:s.opts})}:{ae:t.attrs.id,af:e.s("display:inline;"+t.f),ag:s.opts[4],ah:s.opts[4],ai:[t]},{i:t.name==="img",y:t.name==="br",z:t.name==="a",H:t.name==="video",V:t.name==="table"&&t.c||t.name==="li",ad:!t.c,aj:t.c===2,ar:c})),b:s.attrs.id,c:e.n("_block _"+s.name+" "+s.attrs.class),d:e.s(s.attrs.style)}}typeof p=="function"&&p(_);const x=e._export_sfc(_,[["render",k],["__file","/Users/izcw/Desktop/我的项目/DuoyuWallpaper/uni_modules/mp-html/components/mp-html/node/node.vue"]]);tt.createComponent(x);const w=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));
