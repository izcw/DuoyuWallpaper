"use strict";const e=require("../../common/vendor.js"),f=require("../../api/apis.js");require("../../utils/request.js");if(!Array){const i=e.resolveComponent("uni-search-bar"),o=e.resolveComponent("uni-icons"),r=e.resolveComponent("uv-empty"),u=e.resolveComponent("uni-load-more");(i+o+r+u)()}const S=()=>"../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js",w=()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",k=()=>"../../uni_modules/uv-empty/components/uv-empty/uv-empty.js",x=()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js";Math||(S+w+k+x)();const C={__name:"search",setup(i){const o=e.ref({pageNum:1,pageSize:12,keyword:""}),r=e.ref(e.index.getStorageSync("historySearch")||[]),u=e.ref(["美女","帅哥","宠物","卡通"]),t=e.ref(!1),c=e.ref(!1),n=e.ref([]),v=()=>{e.index.showLoading({title:"搜索中"}),r.value=[...new Set([o.value.keyword,...r.value])].slice(0,10),e.index.setStorageSync("historySearch",r.value),l(o.value.keyword),d()},m=()=>{l()},_=s=>{l(s),v()},y=()=>{e.index.showModal({title:"是否清空历史搜索？",success:s=>{s.confirm&&(e.index.removeStorageSync("historySearch"),r.value=[])}})};e.onReachBottom(()=>{t.value||(o.value.pageNum++,d())}),e.onUnload(()=>{e.index.removeStorageSync("strogClassList")});const l=(s="")=>{n.value=[],t.value=!1,c.value=!1,o.value={pageNum:1,pageSize:12,keyword:s||""}},d=async()=>{try{let s=await f.apiSearchWall(o.value);n.value=[...n.value,...s.data],e.index.setStorageSync("strogClassList",n.value),o.value.pageSize>s.data.length&&(t.value=!0),s.data.length==0&&n.value.length==0&&(c.value=!0)}finally{e.index.hideLoading()}};return(s,L)=>e.e({a:e.o(v),b:e.o(m),c:e.o(m),d:e.o(a=>o.value.keyword=a),e:e.p({focus:!0,placeholder:"搜索",modelValue:o.value.keyword}),f:!n.value.length||c.value},!n.value.length||c.value?e.e({g:r.value.length},r.value.length?{h:e.p({type:"trash",size:"25"}),i:e.o(y),j:e.f(r.value,(a,p,h)=>({a:e.t(a),b:a,c:e.o(g=>_(a))}))}:{},{k:e.f(u.value,(a,p,h)=>({a:e.t(a),b:a,c:e.o(g=>_(a))}))}):{},{l:c.value},c.value?{m:e.p({mode:"search",icon:"/static/search.png"})}:e.e({n:e.f(n.value,(a,p,h)=>({a:a.smallPicurl,b:`/pages/preView/preView?id=${a._id}`,c:a._id})),o:t.value||n.value.length},t.value||n.value.length?{p:e.p({status:t.value?"noMore":"loading"})}:{}))}},b=e._export_sfc(C,[["__scopeId","data-v-c10c040c"],["__file","/Users/izcw/Desktop/我的项目/DuoyuWallpaper/pages/search/search.vue"]]);tt.createPage(b);
